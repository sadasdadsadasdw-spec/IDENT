# Конфигурация интеграции Ident-Битрикс24
# Скопируйте этот файл в config.ini и заполните своими параметрами

[Database]
# Параметры подключения к БД Ident (SQL Server)
server = localhost
port = 1433
database = IdentDB
username = ident_user
# Пароль будет зашифрован автоматически при первом запуске
password = your_password_here
# Таймаут подключения в секундах
connection_timeout = 10
# Таймаут выполнения запроса в секундах
query_timeout = 30

[Bitrix24]
# URL вебхука Битрикс24 (без параметров)
webhook_url = https://your-portal.bitrix24.ru/rest/1/xxxxxxxxxx/
# Токен будет зашифрован автоматически при первом запуске
token = your_webhook_token_here
# Максимальное количество повторных попыток при ошибках API
max_retries = 3
# Задержки между повторами (в секундах): первая, вторая, третья попытка
retry_delays = 30,60,300
# Ограничение запросов в секунду (для соблюдения лимитов API)
rate_limit = 2

[Sync]
# Интервал синхронизации записей в минутах
interval_minutes = 2
# Размер пакета для обработки за один цикл
batch_size = 50
# Глубина начальной синхронизации в днях (при первом запуске)
initial_sync_days = 7
# ID филиала (1-5), используется для формирования уникальных идентификаторов
filial_id = 1

[Logging]
# Уровень логирования: DEBUG, INFO, WARNING, ERROR, CRITICAL
level = INFO
# Путь к директории с логами
log_dir = logs
# Формат имени файла логов
log_filename = integration_log_{date}.txt
# Количество дней хранения логов
rotation_days = 30
# Максимальный размер файла логов в МБ (0 = без ограничений)
max_file_size_mb = 100
# Маскировать персональные данные в логах (True/False)
mask_personal_data = True

[Queue]
# Путь к файлу базы данных очереди
queue_db_path = data/queue.db
# Максимальный размер очереди неотправленных записей
max_queue_size = 1000
# Интервал обработки очереди в минутах
process_interval_minutes = 5

[Monitoring]
# Включить веб-интерфейс мониторинга (True/False)
enabled = True
# Хост веб-сервера
host = localhost
# Порт веб-сервера
port = 8080
# Включить debug режим Flask (только для разработки!)
debug = False

[Notifications]
# Email для уведомлений администратора
admin_email = admin@example.com
# SMTP сервер для отправки email
smtp_server = smtp.gmail.com
smtp_port = 587
smtp_username = your_email@gmail.com
smtp_password = your_email_password
# Порог ошибок для отправки уведомления (процент за час)
error_threshold_percent = 10
# Минимальное количество ошибок для отправки уведомления
error_threshold_count = 5

[Performance]
# Максимальное время обработки одной записи в секундах
max_processing_time = 2
# Пауза между пакетами в секундах (для снижения нагрузки)
batch_pause = 1
# Количество одновременных подключений к БД
db_pool_size = 1

[Security]
# Ключ шифрования (генерируется автоматически при первом запуске)
encryption_key =
# Минимальная версия TLS для HTTPS соединений
min_tls_version = 1.2
# Проверять SSL сертификаты (True/False)
verify_ssl = True

[StageMapping]
# Маппинг стадий воронки Битрикс24
# Формат: STAGE_ID = Название стадии
consultation_scheduled = C1:CONSULTATION_SCHEDULED
consultation_done = C1:CONSULTATION_DONE
plan_presentation = C1:PLAN_PRESENTATION
waiting_list = C1:WAITING_LIST
prepayment_received = C1:PREPAYMENT_RECEIVED
treatment = C1:TREATMENT
won = C1:WON
lose = C1:LOSE

[Advanced]
# Режим отладки (выводит дополнительную информацию)
debug_mode = False
# Сухой прогон (не отправляет данные в Битрикс24, только логирует)
dry_run = False
# Пропускать валидацию (не рекомендуется для продакшена)
skip_validation = False
